"use strict";(self.webpackChunkdocs_1=self.webpackChunkdocs_1||[]).push([[300],{55271:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>d});var a=t(85893),i=t(11151);const s={sidebar_position:4},o="Deploying Astar Blockchain HTTP Server using API Sidecar",r={id:"build/builder-guides/integration_toolings/using-sidecar",title:"Deploying Astar Blockchain HTTP Server using API Sidecar",description:"Overview",source:"@site/docs/build/builder-guides/integration_toolings/using-sidecar.md",sourceDirName:"build/builder-guides/integration_toolings",slug:"/build/builder-guides/integration_toolings/using-sidecar",permalink:"/es/docs/build/builder-guides/integration_toolings/using-sidecar",draft:!1,unlisted:!1,editUrl:"https://github.com/AstarNetwork/astar-docs/tree/main/docs/build/builder-guides/integration_toolings/using-sidecar.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Deploy Astar Portal on Vercel",permalink:"/es/docs/build/builder-guides/integration_toolings/deploy-astar-portal"},next:{title:"Query dApp Staking extrinsics and participating addresses with Python",permalink:"/es/docs/build/builder-guides/integration_toolings/use-python"}},c={},d=[{value:"Overview",id:"overview",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Connecting to a Remote Node",id:"connecting-to-a-remote-node",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",img:"img",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"deploying-astar-blockchain-http-server-using-api-sidecar",children:"Deploying Astar Blockchain HTTP Server using API Sidecar"}),"\n",(0,a.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsx)(n.p,{children:"The Substrate API Sidecar is a REST service that makes it easy to interact with Astar and Shiden."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"diagram",src:t(1937).Z+"",width:"1866",height:"535"})}),"\n",(0,a.jsxs)(n.p,{children:["Instead of having to use the Substrate RPC directly and rely on libraries like ",(0,a.jsx)(n.code,{children:"Astar.js"})," or ",(0,a.jsx)(n.code,{children:"Polkadot.js"}),", you can set up a Substrate API server and interact with the blockchain. For example, you can read block history, listen to events, or submit a transaction, all through a REST API server."]}),"\n",(0,a.jsxs)(n.p,{children:["The source code for the Substrate Sidecar API can be found here: ",(0,a.jsx)(n.a,{href:"https://github.com/paritytech/substrate-api-sidecar",children:"https://github.com/paritytech/substrate-api-sidecar"}),".\nPlease refer to the README of the repository for more information."]}),"\n",(0,a.jsx)(n.p,{children:"Below we will quickly walk through setting up a Substrate API Sidecar."}),"\n",(0,a.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,a.jsx)(n.p,{children:"Install the Sidecar API globally:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm install -g @substrate/api-sidecar\n# OR\nyarn global add @substrate/api-sidecar\n"})}),"\n",(0,a.jsx)(n.p,{children:"Make sure that you are running a local Astar collator for the service can connect to."}),"\n",(0,a.jsx)(n.p,{children:"Run the service from any directory on your machine:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"substrate-api-sidecar\n"})}),"\n",(0,a.jsx)(n.p,{children:"If everything works well, the terminal should display something like this:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'SAS:\n  \ud83d\udce6 LOG:\n     \u2705 LEVEL: "info"\n     \u2705 JSON: false\n     \u2705 FILTER_RPC: false\n     \u2705 STRIP_ANSI: false\n  \ud83d\udce6 SUBSTRATE:\n     \u2705 URL: "ws://127.0.0.1:9944"\n     \u2705 TYPES_BUNDLE: undefined\n     \u2705 TYPES_CHAIN: undefined\n     \u2705 TYPES_SPEC: undefined\n     \u2705 TYPES: undefined\n  \ud83d\udce6 EXPRESS:\n     \u2705 BIND_HOST: "127.0.0.1"\n     \u2705 PORT: 8080\n2023-01-03 16:17:59 info: Version: 14.2.2\n2023-01-03 16:17:59 warn: API/INIT: RPC methods not decorated: transaction_unstable_submitAndWatch, transaction_unstable_unwatch\n2023-01-03 16:17:59 info: Connected to chain Development on the astar-local client at ws://127.0.0.1:9944\n2023-01-03 16:17:59 info: Listening on http://127.0.0.1:8080/\n2023-01-03 16:17:59 info: Check the root endpoint (http://127.0.0.1:8080/) to see the available endpoints for the current node\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Now, you can interact with the blockchain by sending requests to ",(0,a.jsx)(n.code,{children:"http://127.0.0.1:8080/"})," followed by the endpoint."]}),"\n",(0,a.jsxs)(n.p,{children:["For example, ",(0,a.jsx)(n.code,{children:"http://127.0.0.1:8080/blocks/1?finalized=true&eventDocs=true&extrinsicDocs=true"})," will send a request to get the first block's information with full documentation.\nThe result will look something like the following:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "number": "1",\n    "hash": "0xef26181b1317e8fb4263ba071190dcdb17698087aab478a7afd2539b737058eb",\n    "parentHash": "0xd27d60bd31570f15f00fc58ed59c9435845b53a6187e1862a9b1b22cc5991f81",\n    "stateRoot": "0x5597ff6dab02e2a1b2d85fae095d2ee18f6b3a50006f56281c48b1efc881bf1d",\n    "extrinsicsRoot": "0x4dfbaf7d7c5c43417d15c257078d4ad0032ce1fc5d0fc9d34b30b5028a803abc",\n    "logs": [\n        {\n            "type": "PreRuntime",\n            "index": "6",\n            "value": [\n                "0x61757261",\n                "0x6a23da3100000000"\n            ]\n        },\n        {\n            "type": "Consensus",\n            "index": "4",\n            "value": [\n                "0x66726f6e",\n                "0x01661a8c628cd7872ca3477e0f59ef0e0db29fb97f659b7fafb8f394cb9cf1c6ba00"\n            ]\n        },\n        {\n            "type": "Seal",\n            "index": "5",\n            "value": [\n                "0x61757261",\n                "0x4e7ecec532276495c0f31e06c7fde96e5e3f4e38fab5a3bd7a6a4762b06c234ea18c1f10cf5357106be6f32087f354de417ab90779b331f3bd26dfa043976589"\n            ]\n        }\n    ],\n    "onInitialize": {\n        "events": [\n            {\n                "method": {\n                    "pallet": "dappsStaking",\n                    "method": "NewDappStakingEra"\n                },\n                "data": [\n                    "1"\n                ],\n                "docs": "New dapps staking era. Distribute era rewards to contracts."\n            }\n        ]\n    },\n    "extrinsics": [\n        {\n            "method": {\n                "pallet": "timestamp",\n                "method": "set"\n            },\n            "signature": null,\n            "nonce": null,\n            "args": {\n                "now": "1672758996005"\n            },\n            "tip": null,\n            "hash": "0x87a5b2129c9e1ea472fa3115a0f760a4f49c53f758445860c372e07c8e216fbf",\n            "info": {},\n            "era": {\n                "immortalEra": "0x00"\n            },\n            "events": [\n                {\n                    "method": {\n                        "pallet": "balances",\n                        "method": "Deposit"\n                    },\n                    "data": [\n                        "YQnbw3oWxBnCUarnbePrjFcrSgVPP2jqTZYzWcccmN8fXhd",\n                        "1332000000000000000"\n                    ],\n                    "docs": "Some amount was deposited (e.g. for transaction fees)."\n                },\n                {\n                    "method": {\n                        "pallet": "balances",\n                        "method": "Deposit"\n                    },\n                    "data": [\n                        "YQnbw3oWxBk2zTouRxQyxnD2dDCFsGrRGQRaCeDLy7KKMdJ",\n                        "1332000000000000000"\n                    ],\n                    "docs": "Some amount was deposited (e.g. for transaction fees)."\n                },\n                {\n                    "method": {\n                        "pallet": "system",\n                        "method": "NewAccount"\n                    },\n                    "data": [\n                        "YQnbw3oWxBk2zTouRxQyxnD2dDCFsGrRGQRaCeDLy7KKMdJ"\n                    ],\n                    "docs": "A new account was created."\n                },\n                {\n                    "method": {\n                        "pallet": "balances",\n                        "method": "Endowed"\n                    },\n                    "data": [\n                        "YQnbw3oWxBk2zTouRxQyxnD2dDCFsGrRGQRaCeDLy7KKMdJ",\n                        "1332000000000000000"\n                    ],\n                    "docs": "An account was created with some free balance."\n                },\n                {\n                    "method": {\n                        "pallet": "system",\n                        "method": "ExtrinsicSuccess"\n                    },\n                    "data": [\n                        {\n                            "weight": {\n                                "refTime": "260558000",\n                                "proofSize": "0"\n                            },\n                            "class": "Mandatory",\n                            "paysFee": "Yes"\n                        }\n                    ],\n                    "docs": "An extrinsic completed successfully."\n                }\n            ],\n            "success": true,\n            "paysFee": false,\n            "docs": "Set the current time.\\n\\nThis call should be invoked exactly once per block. It will panic at the finalization\\nphase, if this call hasn\'t been invoked by that time.\\n\\nThe timestamp should be greater than the previous one by the amount specified by\\n`MinimumPeriod`.\\n\\nThe dispatch origin for this call must be `Inherent`.\\n\\n# <weight>\\n- `O(1)` (Note that implementations of `OnTimestampSet` must also be `O(1)`)\\n- 1 storage read and 1 storage mutation (codec `O(1)`). (because of `DidUpdate::take` in\\n  `on_finalize`)\\n- 1 event handler `on_timestamp_set`. Must be `O(1)`.\\n# </weight>"\n        }\n    ],\n    "onFinalize": {\n        "events": []\n    },\n    "finalized": true\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["You can find the full endpoint documentation from ",(0,a.jsx)(n.a,{href:"https://paritytech.github.io/substrate-api-sidecar/dist/",children:"this link"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["For transaction signing for the ",(0,a.jsx)(n.code,{children:"/transaction"})," endpoint, please refer to the Polkadot documentation regarding ",(0,a.jsx)(n.a,{href:"https://wiki.polkadot.network/docs/build-transaction-construction",children:"transaction construction"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"connecting-to-a-remote-node",children:"Connecting to a Remote Node"}),"\n",(0,a.jsxs)(n.p,{children:["By default, the Sidecar API will connect to the local node (",(0,a.jsx)(n.code,{children:"ws://127.0.0.1:9944"}),").\nBut you can configure the service to connect to a remote node endpoint."]}),"\n",(0,a.jsxs)(n.p,{children:["First, start by cloning the ",(0,a.jsx)(n.a,{href:"https://github.com/paritytech/substrate-api-sidecar",children:"Sidecar API repository"})," to your system."]}),"\n",(0,a.jsx)(n.p,{children:"Move to the root of the project folder and use the following command to create the configuration file:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"touch .env.astar\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Open the created ",(0,a.jsx)(n.code,{children:".env.astar"})," file with your text editor of choice, and add the following information:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-env",children:"SAS_SUBSTRATE_URL=[RPC Endpoint]\n"})}),"\n",(0,a.jsx)(n.p,{children:"Now run the following commands:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Install the project dependencies\nyarn\n\n# Build the project\nyarn build\n\n# Start the API server locally\nNODE_ENV=astar yarn start\n"})}),"\n",(0,a.jsx)(n.p,{children:"If it worked well, you should see the following console output:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'SAS:\n  \ud83d\udce6 LOG:\n     \u2705 LEVEL: "info"\n     \u2705 JSON: false\n     \u2705 FILTER_RPC: false\n     \u2705 STRIP_ANSI: false\n  \ud83d\udce6 SUBSTRATE:\n     \u2705 URL: "wss://astar.public.blastapi.io"\n     \u2705 TYPES_BUNDLE: undefined\n     \u2705 TYPES_CHAIN: undefined\n     \u2705 TYPES_SPEC: undefined\n     \u2705 TYPES: undefined\n  \ud83d\udce6 EXPRESS:\n     \u2705 BIND_HOST: "127.0.0.1"\n     \u2705 PORT: 8080\n2023-01-03 17:57:35 info: Version: 14.2.2\n2023-01-03 17:57:36 info: Connected to chain Astar on the astar client at wss://astar.public.blastapi.io\n2023-01-03 17:57:36 info: Listening on http://127.0.0.1:8080/\n2023-01-03 17:57:36 info: Check the root endpoint (http://127.0.0.1:8080/) to see the available endpoints for the current node\n'})}),"\n",(0,a.jsx)(n.p,{children:"Of course, you can also configure the Express server (Sidecar API) or explicitly define the chain type bundles or specs.\nFor more information, please refer to the README of the Substrate Sidecar API repository."})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},1937:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/sidecar-diagram-b76af7e528ec81a9d0a7bad85335c5ef.jpg"},11151:(e,n,t)=>{t.d(n,{Z:()=>r,a:()=>o});var a=t(67294);const i={},s=a.createContext(i);function o(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);