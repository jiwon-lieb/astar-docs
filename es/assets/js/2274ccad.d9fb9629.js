"use strict";(self.webpackChunkdocs_1=self.webpackChunkdocs_1||[]).push([[2249],{34194:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>d,toc:()=>a});var s=t(85893),r=t(11151);const o={sidebar_position:1,title:"Setup Astar zkEVM Testnet Permissionless RPC Node",sidebar_label:"Setup zkEVM Testnet RPC"},i=void 0,d={id:"build/zkEVM/zk-node/setup-testnet-rpc-node",title:"Setup Astar zkEVM Testnet Permissionless RPC Node",description:"Overview",source:"@site/docs/build/zkEVM/zk-node/setup-testnet-rpc-node.md",sourceDirName:"build/zkEVM/zk-node",slug:"/build/zkEVM/zk-node/setup-testnet-rpc-node",permalink:"/es/docs/build/zkEVM/zk-node/setup-testnet-rpc-node",draft:!1,unlisted:!1,editUrl:"https://github.com/AstarNetwork/astar-docs/tree/main/docs/build/zkEVM/zk-node/setup-testnet-rpc-node.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Setup Astar zkEVM Testnet Permissionless RPC Node",sidebar_label:"Setup zkEVM Testnet RPC"},sidebar:"tutorialSidebar",previous:{title:"Setup zkEVM Mainnet RPC",permalink:"/es/docs/build/zkEVM/zk-node/setup-mainnet-rpc-node"},next:{title:"Fee Calculation",permalink:"/es/docs/build/zkEVM/fee"}},l={},a=[{value:"Overview",id:"overview",level:2},{value:"Requirements",id:"requirements",level:2},{value:"System",id:"system",level:3},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Ethereum RPC Node",id:"ethereum-rpc-node",level:3},{value:"Setting Up zkNode",id:"setting-up-zknode",level:2},{value:"Using RPC",id:"using-rpc",level:2},{value:"Extra",id:"extra",level:2},{value:"Enable tracing",id:"enable-tracing",level:3},{value:"Access from outside",id:"access-from-outside",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(n.p,{children:["Operators can deploy permissionless RPC nodes for ",(0,s.jsx)(n.strong,{children:"Astar zkEVM"})," testnet, named ",(0,s.jsx)(n.strong,{children:"zKyoto"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"DApp projects must run their own RPC node to retrieve the necessary blockchain data and shouldn't rely on public infrastructure. Public endpoints may respond slowly or not at all during times of high network traffic, and are rate limited."}),"\n",(0,s.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,s.jsx)(n.h3,{id:"system",children:"System"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"Storage space requirements will increase as the network grows."})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"16GB RAM"}),"\n",(0,s.jsx)(n.li,{children:"4-core CPU"}),"\n",(0,s.jsx)(n.li,{children:"100GB Storage (This will increase over time)"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(n.p,{children:["This tutorial requires ",(0,s.jsx)(n.code,{children:"docker"})," and ",(0,s.jsx)(n.code,{children:"docker-compose"})," to be installed on your machine. If you don\u2019t have these installed, check out the links provided below:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.docker.com/get-started",children:"https://www.docker.com/get-started"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.docker.com/compose/install/",children:"https://docs.docker.com/compose/install/"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"ethereum-rpc-node",children:"Ethereum RPC Node"}),"\n",(0,s.jsxs)(n.p,{children:["A Sepolia (Ethereum testnet) RPC node is required for running an ",(0,s.jsx)(n.strong,{children:"Astar zkEVM"})," testnet node.\nThere are two options available:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Setup your own - the ",(0,s.jsx)(n.a,{href:"https://geth.ethereum.org/docs/getting-started/installing-geth",children:"Geth client"})," is one example."]}),"\n",(0,s.jsx)(n.li,{children:"Use an RPC provider endpoint - developers building on Astar may be entitled to special offers or promos."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["This document does not cover the installation of the Ethereum node. We will use a public RPC endpoint for this document, but keep in mind that ",(0,s.jsx)(n.strong,{children:"this is not a viable production solution"}),": public endpoints are rate limited and as a result, your Astar zkEVM node may not synchronize correctly."]}),"\n",(0,s.jsx)(n.h2,{id:"setting-up-zknode",children:"Setting Up zkNode"}),"\n",(0,s.jsxs)(n.p,{children:["In this section, we are going to start the five containers necessary for the ",(0,s.jsx)(n.strong,{children:"Astar zkEVM"})," RPC node to function:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"zkevm-rpc"}),"\n",(0,s.jsx)(n.li,{children:"zkevm-sync"}),"\n",(0,s.jsx)(n.li,{children:"zkevm-state-db"}),"\n",(0,s.jsx)(n.li,{children:"zkevm-pool-db"}),"\n",(0,s.jsx)(n.li,{children:"zkevm-prover"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["At the time of this writing, ",(0,s.jsx)(n.strong,{children:"zKyoto testnet"})," is the only network available for the ",(0,s.jsx)(n.strong,{children:"Astar zkEVM"}),", and is connected to the L1 Ethereum ",(0,s.jsx)(n.strong,{children:"Sepolia testnet"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Let's build on this."}),"\n",(0,s.jsx)(n.p,{children:"Create dedicated directories for config, install and data."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo mkdir -p /etc/zkevm && sudo chown -R $USER:$USER /etc/zkevm\nsudo mkdir -p /var/lib/zkevm/{statedb,pooldb} && sudo chown -R $USER:$USER /var/lib/zkevm/\n"})}),"\n",(0,s.jsx)(n.p,{children:"Set local variables."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"# define installation and config path\nZKEVM_NET=testnet\nZKEVM_DIR=/etc/zkevm\n"})}),"\n",(0,s.jsx)(n.p,{children:"Download and extract the artifacts."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"wget https://shared-assets.astar.network/files/zkevm/zkyoto/zkyoto.tar.gz\ntar -xf zkyoto.tar.gz -C $ZKEVM_DIR && rm zkyoto.tar.gz\n"})}),"\n",(0,s.jsx)(n.p,{children:"Copy the env file and edit the L1 RPC URL."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cp $ZKEVM_DIR/example.env $ZKEVM_DIR/.env\nnano $ZKEVM_DIR/.env\n"})}),"\n",(0,s.jsx)(n.p,{children:"Modify the parameters."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Use your own Sepolia RPC URL here!!\nZKEVM_NODE_ETHERMAN_URL = "https://eth-sepolia-public.unifra.io"\n'})}),"\n",(0,s.jsx)(n.p,{children:"Edit the node config file."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nano $ZKEVM_DIR/config/environments/$ZKEVM_NET/node.config.toml\n"})}),"\n",(0,s.jsx)(n.p,{children:"Modify the following parameters, you may also want to change the databases default user/passwords for more security."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'[Etherman]\n# Set your own Sepolia RPC URL\nURL = "https://eth-sepolia-public.unifra.io"\n\n# Enable if you want to exploit metrics from nodes\n[Metrics]\nEnabled = true\n'})}),"\n",(0,s.jsx)(n.p,{children:"Start the containers."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"\n# start all the containers\nsudo docker compose --env-file $ZKEVM_DIR/.env -f $ZKEVM_DIR/docker-compose.yml up -d\n# or start containers on by one\nsudo docker compose --env-file $ZKEVM_DIR/.env -f $ZKEVM_DIR/docker-compose.yml up -d <container-name>\n"})}),"\n",(0,s.jsx)(n.p,{children:"Verify that all containers are up and running: you should see the 5 containers with a status Up."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo docker ps\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Now you have an ",(0,s.jsx)(n.strong,{children:"Astar zkEVM"})," testnet RPC node up and running on port 8545, you just have to wait for it to synchronize."]}),"\n",(0,s.jsx)(n.h2,{id:"using-rpc",children:"Using RPC"}),"\n",(0,s.jsx)(n.p,{children:"View container logs."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo docker logs -fn30 <container-name>\n"})}),"\n",(0,s.jsx)(n.p,{children:"Test RPC requests."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Get the chain Id\ncurl -H "Content-Type: application/json" -d \'{"id":1, "jsonrpc":"2.0", "method": "eth_chainId", "params": []}\' http://localhost:8545\n# Expected response\n{"jsonrpc":"2.0","id":1,"result":"0x133e40"}\n# Get the latest block\ncurl -H "Content-Type: application/json" -d \'{"id":1, "jsonrpc":"2.0", "method": "eth_getBlockByNumber", "params": ["latest", false]}\' http://localhost:8545\n'})}),"\n",(0,s.jsx)(n.p,{children:"Stop containers."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo docker compose --env-file $ZKEVM_DIR/.env -f $ZKEVM_DIR/docker-compose.yml down\n"})}),"\n",(0,s.jsx)(n.h2,{id:"extra",children:"Extra"}),"\n",(0,s.jsx)(n.h3,{id:"enable-tracing",children:"Enable tracing"}),"\n",(0,s.jsxs)(n.p,{children:["To enable tracing features (",(0,s.jsx)(n.code,{children:"debug"})," and ",(0,s.jsx)(n.code,{children:"txpool"})," modules) on the RPC, add the following command to the ",(0,s.jsx)(n.code,{children:"zkevm-rpc"})," container in the ",(0,s.jsx)(n.code,{children:"docker-compose"})," file:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"--http.api=eth,net,debug,zkevm,txpool,web3\n"})}),"\n",(0,s.jsx)(n.h3,{id:"access-from-outside",children:"Access from outside"}),"\n",(0,s.jsxs)(n.p,{children:["To make a RPC endpoint URL available from outside, it is recommended to add a HTTP server.\nYou can refer to this section to install an ",(0,s.jsx)(n.a,{href:"/docs/build/nodes/archive-node/nginx",children:"nginx server"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},11151:(e,n,t)=>{t.d(n,{Z:()=>d,a:()=>i});var s=t(67294);const r={},o=s.createContext(r);function i(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);