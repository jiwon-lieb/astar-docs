"use strict";(self.webpackChunkdocs_1=self.webpackChunkdocs_1||[]).push([[8337],{61024:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>d});var s=i(85893),t=i(11151);const o={sidebar_position:6},r="Zombienet",c={id:"build/environment/zombienet-testing",title:"Zombienet",description:"This page is intended for developers & builders.",source:"@site/docs/build/environment/zombienet-testing.md",sourceDirName:"build/environment",slug:"/build/environment/zombienet-testing",permalink:"/docs/build/environment/zombienet-testing",draft:!1,unlisted:!1,editUrl:"https://github.com/AstarNetwork/astar-docs/tree/main/docs/build/environment/zombienet-testing.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Running Local Network",permalink:"/docs/build/environment/local-network"},next:{title:"Chopsticks & E2E Tests",permalink:"/docs/build/environment/chopsticks"}},a={},d=[{value:"The Problem",id:"the-problem",level:2},{value:"Zombienet",id:"zombienet-1",level:2},{value:"Shibuya - Shiden Test Network",id:"shibuya---shiden-test-network",level:2},{value:"Overview",id:"overview",level:3},{value:"Basic Setup Instructions",id:"basic-setup-instructions",level:3},{value:"Basic Cross-Chain Assets Setup Instructions",id:"basic-cross-chain-assets-setup-instructions",level:3},{value:"Basic Remote Execution Instructions",id:"basic-remote-execution-instructions",level:3}];function l(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,t.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"zombienet",children:"Zombienet"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"This page is intended for developers & builders."})}),"\n",(0,s.jsx)(n.h2,{id:"the-problem",children:"The Problem"}),"\n",(0,s.jsx)(n.p,{children:"Finding the right environment for testing XCM features, both standalone or with smart contracts, can be difficult since it requires at least two parachains with open HRMP channels and a Relay Chain. The parachains need to have the features we rely on in testing."}),"\n",(0,s.jsxs)(n.p,{children:["At the moment, only production networks, like ",(0,s.jsx)(n.code,{children:"Astar"})," or ",(0,s.jsx)(n.code,{children:"Shiden"}),", have access to a great number of HRMP channels with various parachains. Testing in production isn't a good idea though and should be avoided. A possible alternative is to use ",(0,s.jsx)(n.code,{children:"Rococo"})," as a Relay Chain and the connected parachains, if they are available. Not all projects deploy a testnet on Rococo."]}),"\n",(0,s.jsx)(n.h2,{id:"zombienet-1",children:"Zombienet"}),"\n",(0,s.jsxs)(n.p,{children:["The approach that gives users the most control is to setup a local test network, with both the Relay Chain and parachain(s). This is very simple & easy to do using the ",(0,s.jsx)(n.a,{href:"https://github.com/paritytech/zombienet",children:"zombienet"})," tool provided by Parity. Simply put, users can download arbitrary Relay Chain and parachain binaries (or use images) to setup a configurable local test network. Users will have access to all privileged actions on the Relay Chain and on the parachains which makes testing much easier."]}),"\n",(0,s.jsxs)(n.p,{children:["For example, user can download ",(0,s.jsx)(n.code,{children:"polkadot"})," binary together with ",(0,s.jsx)(n.code,{children:"astar-collator"})," and ",(0,s.jsx)(n.code,{children:"cumulus-parachain"})," to spin up a testnetwork with ",(0,s.jsx)(n.code,{children:"polkadot"})," as Relay Chain, ",(0,s.jsx)(n.code,{children:"astar"})," as one parachain and ",(0,s.jsx)(n.code,{children:"statemint"})," as the second parachain."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Zombienet"})," documentation can be found ",(0,s.jsx)(n.a,{href:"https://paritytech.github.io/zombienet/",children:"here"}),", including the installation instructions, CLI usage, guide with examples and many more. Users are advised to consult this document to get a better understanding of the tool."]}),"\n",(0,s.jsx)(n.h2,{id:"shibuya---shiden-test-network",children:"Shibuya - Shiden Test Network"}),"\n",(0,s.jsx)(n.h3,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(n.p,{children:["A quick reminder - ",(0,s.jsx)(n.code,{children:"Shibuya"})," is a test network with no market value used by ",(0,s.jsx)(n.code,{children:"Astar & Shiden"})," team to test features before deploying into production. It uses a custom ",(0,s.jsx)(n.strong,{children:"Rococo"})," based Relay Chain. ",(0,s.jsx)(n.code,{children:"Shiden"})," is a production canary-type network connected to ",(0,s.jsx)(n.code,{children:"Kusama"}),". These two parachains aren't aware of one another and do not communicate in live networks."]}),"\n",(0,s.jsxs)(n.p,{children:["However, using ",(0,s.jsx)(n.code,{children:"zombienet"}),", users can setup a local test network where one parachain would be ",(0,s.jsx)(n.code,{children:"Shibuya"})," and the other would be ",(0,s.jsx)(n.code,{children:"Shiden"})," with ",(0,s.jsx)(n.strong,{children:"HRMP"})," channels opened between them. This is incredibly useful for testing & integration because it gives users the option for cross-chain communication between two smart-contract oriented parachains which support Wasm smart contracts, amongst many other features."]}),"\n",(0,s.jsxs)(n.p,{children:["The following instructions will explain how to setup & configure local ",(0,s.jsx)(n.em,{children:"Shibuya - Shiden test network"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"basic-setup-instructions",children:"Basic Setup Instructions"}),"\n",(0,s.jsxs)(n.p,{children:["For users who already know what they are doing, please check ",(0,s.jsx)(n.a,{href:"https://github.com/AstarNetwork/Astar/tree/master/third-party/zombienet",children:"this"})," folder in ",(0,s.jsx)(n.code,{children:"Astar"})," repository for ",(0,s.jsx)(n.em,{children:"ready-to-use"})," ",(0,s.jsx)(n.code,{children:"zombienet"})," configurations."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["For the sake of simplicity, prepare a folder called ",(0,s.jsx)(n.code,{children:"zombienet"})," into which ",(0,s.jsx)(n.strong,{children:"ALL"})," binaries and config files will be placed."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Download ",(0,s.jsx)(n.code,{children:"zombienet"})," binary appropriate for your operating system (or install it in any way you prefer)."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Download ",(0,s.jsx)(n.code,{children:"polkadot"})," binary and ",(0,s.jsx)(n.code,{children:"astar-collator"})," binary. They can be found as part of release in official ",(0,s.jsx)(n.a,{href:"https://github.com/paritytech/polkadot/releases",children:"polkadot"})," and ",(0,s.jsx)(n.a,{href:"https://github.com/AstarNetwork/Astar/releases",children:"Astar"})," repositories."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Use the configuration file ",(0,s.jsx)(n.code,{children:"multi_parachains.toml"})," which can be found ",(0,s.jsx)(n.a,{href:"https://github.com/AstarNetwork/Astar/tree/master/third-party/zombienet",children:"here"}),". Make sure to check the file to get a sense of which parameters are being used."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Start the network. This is a command example: ",(0,s.jsx)(n.code,{children:"./zombienet-linux -p native spawn multi_parachains.toml"}),". However, you can start the network in your preferred way (e.g. using ",(0,s.jsx)(n.code,{children:"podman"})," or ",(0,s.jsx)(n.code,{children:"kubernetes"}),")."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Lots of useful information will be printed, like commands used to generate chain specifications and commands used to start the network (useful for extracting RPC ports). At the end, a table with direct links to node's ",(0,s.jsx)(n.code,{children:"polkadot-js page"})," will be created. Use this to interact with chain from your browser."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["After a minute or two, block production on both ",(0,s.jsx)(n.code,{children:"Shibuya"})," and ",(0,s.jsx)(n.code,{children:"Shiden"})," should start. This will usually happen after ",(0,s.jsx)(n.strong,{children:"Relay Chain"})," reaches block 11, which will trigger a new session. HRMP channels will automatically be configured between the parachains (check the configuration file)."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The test network is running and users can interract with Relay Chain and both parachains. It is now possible to deploy EVM and Wasm smart contracts, send XCM instructions and do everything else what is possible on live chains. In addition, users have direct access to ",(0,s.jsx)(n.code,{children:"Alice"})," account, which has ",(0,s.jsx)(n.code,{children:"sudo"})," privileges."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"We will provide automated way of performing these setup actions in the future."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"basic-cross-chain-assets-setup-instructions",children:"Basic Cross-Chain Assets Setup Instructions"}),"\n",(0,s.jsx)(n.p,{children:"After completing the previous steps, a local test network with two parachains is running.\nThe following steps will explain how to setup basic cross-chain payable assets for both parachains."}),"\n",(0,s.jsxs)(n.p,{children:["The aim is to configure a cross-chain ",(0,s.jsx)(n.strong,{children:"SDN"})," asset on ",(0,s.jsx)(n.code,{children:"Shibuya"})," and cross-chain ",(0,s.jsx)(n.strong,{children:"SBY"})," asset on ",(0,s.jsx)(n.code,{children:"Shiden"}),". Both assets will be configured as ",(0,s.jsx)(n.em,{children:"payable"}),", meaning they can be used to pay for XCM execution on the remote chain."]}),"\n",(0,s.jsxs)(n.p,{children:["For all steps, encoded call data will be provided to simplify the process for the user. Call data can be copy/pasted into field under ",(0,s.jsx)(n.code,{children:"Developer -> Extrinsic -> Decode"}),". ",(0,s.jsx)(n.strong,{children:"ALL"})," calls should be executed as ",(0,s.jsx)(n.code,{children:"Alice"}),"."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["In the local ",(0,s.jsx)(n.code,{children:"Shibuya polkadot-js"})," explorer, create a new asset for the cross-chain SDN wrapper. Configure it to be sufficient and payable."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"0x0b000c630024015000d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d010463003600010101005d1f5063003601010101005d1f070010a5d4e8\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:["In the local ",(0,s.jsx)(n.code,{children:"Shiden polkadot-js"})," explorer, create a new asset for the cross-chain SBY wrapper. Same concept as in the previous step."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"0x0b000c630024015000d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d01046300360001010100411f506300360101010100411f070010a5d4e8\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsxs)(n.li,{children:["In the local ",(0,s.jsx)(n.code,{children:"Shibuya polkadot-js"})," explorer, send ",(0,s.jsx)(n.strong,{children:"1000 SBY"})," to ",(0,s.jsx)(n.code,{children:"Alice"})," on Shiden."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"0x3302010101005d1f0100010100d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d010400000000170000a0dec5adc9353600000000\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsxs)(n.li,{children:["In the local ",(0,s.jsx)(n.code,{children:"Shiden polkadot-js"})," explorer, send ",(0,s.jsx)(n.strong,{children:"1000 SDN"})," to ",(0,s.jsx)(n.code,{children:"Alice"})," on Shibuya."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"0x330201010100411f0100010100d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d010400000000170000a0dec5adc9353600000000\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"5",children:["\n",(0,s.jsxs)(n.li,{children:["Check that ",(0,s.jsx)(n.code,{children:"Alice"})," on both chains received the assets (minus the execution fee)."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"basic-remote-execution-instructions",children:"Basic Remote Execution Instructions"}),"\n",(0,s.jsxs)(n.p,{children:["After completing the previous steps, cross-chain SDN and SBY wrappers are configured as payable and sufficient assets.\nThe following steps will explain how to execute a cross-chain remote call. ",(0,s.jsx)(n.code,{children:"Alice"})," will send an instruction from ",(0,s.jsx)(n.code,{children:"Shiden"})," to execute ",(0,s.jsx)(n.code,{children:"System::remark_with_event"})," on ",(0,s.jsx)(n.code,{children:"Shibuya"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Alice"})," isn't able to directly control ",(0,s.jsx)(n.code,{children:"Alice"})," on the destination chain, instead a new account will be derived. More information can be found ",(0,s.jsx)(n.a,{href:"/docs/learn/interoperability/xcm/building-with-xcm/xc-remote-transact/#derived-remote-accounts",children:"here"}),"."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Calculate ",(0,s.jsx)(n.code,{children:"Alice's"})," derived account on ",(0,s.jsx)(n.code,{children:"Shibuya"})," when sending instructions from ",(0,s.jsx)(n.code,{children:"Shiden"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"> ./xcm-tools remote-account -p 2007 -a 0xd43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d\n5Cvcv8RvSsp6go2pQ8FRXcGLAzNp5eyC8Je7KLHz5zFwuUyT\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Fund the ",(0,s.jsx)(n.code,{children:"5Cvcv8RvSsp6go2pQ8FRXcGLAzNp5eyC8Je7KLHz5zFwuUyT"})," account on ",(0,s.jsx)(n.code,{children:"Shibuya"})," (send it some SBY tokens)."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["On ",(0,s.jsx)(n.code,{children:"Shiden"}),", as ",(0,s.jsx)(n.code,{children:"Alice"}),", send an XCM sequence instructing ",(0,s.jsx)(n.code,{children:"Shibuya"})," to execute ",(0,s.jsx)(n.code,{children:"System::remark_with_event"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"0x330001010100411f021400040000000013000064a7b3b6e00d130000000013000064a7b3b6e00d00060102286bee200a07144173746172140d010004000101002611a3b92e2351f8b6c98b7b0654dc1daab45b2619ea357a848d4fe2b5ae1863\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsxs)(n.li,{children:["Observe successful XCM execution on ",(0,s.jsx)(n.code,{children:"Shibuya"})," and inspect the block to observe ",(0,s.jsx)(n.code,{children:"remark"})," event."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>c,a:()=>r});var s=i(67294);const t={},o=s.createContext(t);function r(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);