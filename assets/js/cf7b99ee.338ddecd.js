"use strict";(self.webpackChunkdocs_1=self.webpackChunkdocs_1||[]).push([[9957],{92671:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var t=o(85893),s=o(11151);const r={sidebar_position:1,title:"Setup Local Rollup Node",sidebar_label:"Setup Local Rollup Node"},i=void 0,l={id:"build/zkEVM/zk-node/setup-local-rollup-node",title:"Setup Local Rollup Node",description:"Rollup version of ZK is used on Astar zKatana environment.",source:"@site/docs/build/zkEVM/zk-node/setup-local-rollup-node.md",sourceDirName:"build/zkEVM/zk-node",slug:"/build/zkEVM/zk-node/setup-local-rollup-node",permalink:"/docs/build/zkEVM/zk-node/setup-local-rollup-node",draft:!1,unlisted:!1,editUrl:"https://github.com/AstarNetwork/astar-docs/tree/main/docs/build/zkEVM/zk-node/setup-local-rollup-node.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Setup Local Rollup Node",sidebar_label:"Setup Local Rollup Node"},sidebar:"tutorialSidebar",previous:{title:"zkNode",permalink:"/docs/build/zkEVM/zk-node/"},next:{title:"Setup Local Validium Node",permalink:"/docs/build/zkEVM/zk-node/setup-local-validium-node"}},a={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"System Requirements",id:"system-requirements",level:3},{value:"Setting Up zkNode",id:"setting-up-zknode",level:2},{value:"Configuration Parameters",id:"configuration-parameters",level:2},{value:"Sample Data",id:"sample-data",level:2},{value:"Connecting to Metamask",id:"connecting-to-metamask",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsx)(n.mdxAdmonitionTitle,{}),(0,t.jsx)(n.p,{children:"Rollup version of ZK is used on Astar zKatana environment."})]}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["Due to an open ",(0,t.jsx)(n.a,{href:"https://github.com/ethereum/go-ethereum/issues/27274",children:"issue"})," you may encounter problems running a local node."]})}),"\n",(0,t.jsxs)(n.p,{children:["It's crucial that developers can thoroughly test the network for a developing blockchain technology like ",(0,t.jsx)(n.strong,{children:"Astar zkEVM"})," without putting users or themselves at unnecessary risk. Developers should be able to test their smart contracts, experiment with new code, and play around with the network on their local machines."]}),"\n",(0,t.jsx)(n.p,{children:"Astar zkEVM has a local development environment setup for this reason. This tutorial will help you create a local single-node zkEVM blockchain with no connections to external peers. It only exists on your local machine."}),"\n",(0,t.jsxs)(n.admonition,{type:"caution",children:[(0,t.jsx)(n.p,{children:"Currently the zkProver does not run on ARM-powered Macs. For Windows users, using WSL/WSL2 is not recommended."}),(0,t.jsx)(n.p,{children:"Unfortunately, Apple M chips are not supported for now - since some optimizations on the zkProver require specific Intel instructions. This means some non-M computers won't work regardless of the OS, for example: AMD."})]}),"\n",(0,t.jsx)(n.p,{children:"After completing this tutorial, you will have the following components running:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"zkEVM Node Databases"}),"\n",(0,t.jsx)(n.li,{children:"Explorer Databases"}),"\n",(0,t.jsx)(n.li,{children:"L1 Network"}),"\n",(0,t.jsx)(n.li,{children:"Prover"}),"\n",(0,t.jsx)(n.li,{children:"zkEVM Node components"}),"\n",(0,t.jsx)(n.li,{children:"Explorers"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.p,{children:["The tutorial for current version of the environment requires ",(0,t.jsx)(n.code,{children:"go"}),", ",(0,t.jsx)(n.code,{children:"docker"})," and ",(0,t.jsx)(n.code,{children:"docker-compose"})," to be previously installed on your machine. If you don\u2019t have these installed, check out the links provided below:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://go.dev/doc/install",children:"https://go.dev/doc/install"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.docker.com/get-started",children:"https://www.docker.com/get-started"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.docker.com/compose/install/",children:"https://docs.docker.com/compose/install/"})}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"system-requirements",children:"System Requirements"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"zkEVM Node: 16GB RAM with 4-core CPU"}),"\n",(0,t.jsx)(n.li,{children:"zkProver: 1TB RAM with 128-core CPU"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"If you want to run a full-fledged zkProver on your own, you'll need at least 1TB of RAM. If you are unable to meet the Prover requirements, you can still run the zkNode."}),"\n",(0,t.jsx)(n.h2,{id:"setting-up-zknode",children:"Setting Up zkNode"}),"\n",(0,t.jsxs)(n.p,{children:["Before starting the zkEVM node setup, we need to clone the ",(0,t.jsx)(n.a,{href:"https://github.com/0xPolygonHermez/zkevm-node",children:"official zkNode repository"})," from Polygon zkEVM Github."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/0xPolygonHermez/zkevm-node.git\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"zkevm-node"})," docker image must be built at least once and whenever the code is changed. If you haven't already built the ",(0,t.jsx)(n.code,{children:"zkevm-node"})," image, you must run:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"make build-docker\n"})}),"\n",(0,t.jsxs)(n.admonition,{title:"Building Docker Image",type:"caution",children:[(0,t.jsxs)(n.p,{children:["For a given version of the Testnet implementation, be sure to use configuration files from the correct and corresponding tag. For instance: ",(0,t.jsx)(n.strong,{children:"to build an RC9 image, use configuration files from RC9 tag"}),"."]}),(0,t.jsxs)(n.p,{children:["All tags can be found here: ",(0,t.jsx)("ins",{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"https://github.com/0xPolygonHermez/zkevm-node/tags",children:"https://github.com/0xPolygonHermez/zkevm-node/tags"})})})]})]}),"\n",(0,t.jsxs)(n.p,{children:["Certain commands on the ",(0,t.jsx)(n.code,{children:"zkevm-node"})," can interact with smart contracts, run specific components, create encryption files, and print debug information."]}),"\n",(0,t.jsxs)(n.p,{children:["To interact with the binary program, we provide ",(0,t.jsx)(n.code,{children:"docker-compose"}),"\xa0files and a ",(0,t.jsx)(n.code,{children:"Makefile"})," to spin up/down the various services and components, ensuring smooth local deployment and a better command line interface for developers."]}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"All the data is stored inside of each docker container. This means once you remove the container, the data will be lost."})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"test/"})," directory contains scripts and files for developing and debugging. Change the working directory to ",(0,t.jsx)(n.code,{children:"test/"})," on your local machine."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd test/\n"})}),"\n",(0,t.jsx)(n.p,{children:"Now, run the zkNode environment:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"make run\n"})}),"\n",(0,t.jsx)(n.p,{children:"To stop the zkNode:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"make stop\n"})}),"\n",(0,t.jsx)(n.p,{children:"To restart the whole zkNode environment:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"make restart\n"})}),"\n",(0,t.jsx)(n.h2,{id:"configuration-parameters",children:"Configuration Parameters"}),"\n",(0,t.jsxs)(n.p,{children:["\u200b\nThe Synchronizer regularly pulls for network updates, mainly from Ethereum but also via the ",(0,t.jsx)(n.strong,{children:"Trusted Sequencer"}),"'s broadcasting mechanism, in order to stay up-to-date. Unless otherwise specified in the setup, the Synchronizer's ",(0,t.jsx)(n.strong,{children:"default syncing rate"})," is every ",(0,t.jsx)(n.strong,{children:"2 seconds"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"Keystore"})," file, used to ",(0,t.jsx)(n.strong,{children:"store private keys"}),", is normally required for running the Sequencer & Aggregator but not for a Synchronizer/RPC-setup."]}),"\n",(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsxs)(n.p,{children:["We have the inconvenient situation where the ",(0,t.jsx)(n.strong,{children:"Keystore"})," file is required to run the node when it shouldn't be, for example, if no transactions are sent to L1. ",(0,t.jsx)(n.strong,{children:"Keystore is not required in the Mango Testnet"})," as it uses a trusted sequencer and aggregator."]}),(0,t.jsx)(n.p,{children:"This will be reviewed when a decentralised zkEVM network is implemented."})]}),"\n",(0,t.jsx)(n.h2,{id:"sample-data",children:"Sample Data"}),"\n",(0,t.jsxs)(n.p,{children:["It's important to populate your local zkEVM node with some data before you start testing out the network. The ",(0,t.jsx)(n.code,{children:"make run"})," command will execute the containers required to run the environment, but it will not execute anything else. ",(0,t.jsx)(n.strong,{children:"Your local L2 network will be essentially empty"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"The following scripts are available if you require sample data that has already been deployed to the network."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# To add some examples of transactions and smart contracts:\nmake deploy-sc\n\n# To deploy a full Uniswap environment:\nmake deploy-uniswap\n\n# To grant the MATIC smart contract a set amount of tokens:\nmake run-approve-matic\n"})}),"\n",(0,t.jsx)(n.h2,{id:"connecting-to-metamask",children:"Connecting to Metamask"}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"Metamask requires the network to be running while configuring it, so make sure your network is up."})}),"\n",(0,t.jsx)(n.p,{children:"To configure your MetaMask to use your local zkEVM environment, follow these steps:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Log in to your MetaMask wallet"}),"\n",(0,t.jsxs)(n.li,{children:["Click on your account picture and then on ",(0,t.jsx)(n.strong,{children:"Settings"})]}),"\n",(0,t.jsxs)(n.li,{children:["On the left menu, click on ",(0,t.jsx)(n.strong,{children:"Networks"})]}),"\n",(0,t.jsxs)(n.li,{children:["Click on ",(0,t.jsx)(n.strong,{children:"Add Network"})," button"]}),"\n",(0,t.jsxs)(n.li,{children:["Fill up the L2 network information","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Network Name:"})," Astar zkEVM - Local"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"New RPC URL:"})," ",(0,t.jsx)(n.a,{href:"http://localhost:8123",children:"http://localhost:8123"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"ChainID:"})," 1001"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Currency Symbol:"})," ETH"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Block Explorer URL:"})," ",(0,t.jsx)(n.a,{href:"http://localhost:4000",children:"http://localhost:4000"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Click on ",(0,t.jsx)(n.strong,{children:"Save"})]}),"\n",(0,t.jsxs)(n.li,{children:["Click on ",(0,t.jsx)(n.strong,{children:"Add Network"})," button"]}),"\n",(0,t.jsxs)(n.li,{children:["Fill up the L1 network information","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Network Name:"})," Geth - Local"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"New RPC URL:"})," ",(0,t.jsx)(n.a,{href:"http://localhost:8545",children:"http://localhost:8545"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"ChainID:"})," 1337"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Currency Symbol:"})," ETH"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Click on ",(0,t.jsx)(n.strong,{children:"Save"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"You can now interact with your local zkEVM network and sign transactions from your MetaMask wallet."})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},11151:(e,n,o)=>{o.d(n,{Z:()=>l,a:()=>i});var t=o(67294);const s={},r=t.createContext(s);function i(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);