"use strict";(self.webpackChunkdocs_1=self.webpackChunkdocs_1||[]).push([[1763],{27961:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>h,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var t=n(85893),s=n(11151);n(3837);const a={sidebar_position:4},i="The Graph",o={id:"build/integrations/indexers/thegraph",title:"The Graph",description:"The Graph Quick Start",source:"@site/docs/build/integrations/indexers/thegraph.md",sourceDirName:"build/integrations/indexers",slug:"/build/integrations/indexers/thegraph",permalink:"/ja/docs/build/integrations/indexers/thegraph",draft:!1,unlisted:!1,editUrl:"https://github.com/AstarNetwork/astar-docs/tree/main/docs/build/integrations/indexers/thegraph.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Subscan",permalink:"/ja/docs/build/integrations/indexers/subscan"},next:{title:"OnFinality Unified NFT API",permalink:"/ja/docs/build/integrations/indexers/onfinality"}},h={},l=[{value:"The Graph Quick Start",id:"the-graph-quick-start",level:2},{value:"1. Initialize your subgraph project",id:"1-initialize-your-subgraph-project",level:2},{value:"Create a subgraph on Subgraph Studio\u2060",id:"create-a-subgraph-on-subgraph-studio",level:3},{value:"Install the Graph CLI\u2060",id:"install-the-graph-cli",level:3},{value:"Initialize your Subgraph\u2060",id:"initialize-your-subgraph",level:3},{value:"2. Deploy &amp; Publish",id:"2-deploy--publish",level:2},{value:"Deploy to Subgraph Studio\u2060",id:"deploy-to-subgraph-studio",level:3},{value:"Test your subgraph\u2060",id:"test-your-subgraph",level:3},{value:"Publish Your Subgraph to The Graph\u2019s Decentralized Network",id:"publish-your-subgraph-to-the-graphs-decentralized-network",level:3},{value:"3. Query your Subgraph",id:"3-query-your-subgraph",level:2},{value:"Getting your own API Key",id:"getting-your-own-api-key",level:3},{value:"Appendix",id:"appendix",level:2},{value:"Sample Query",id:"sample-query",level:3},{value:"Sample code",id:"sample-code",level:3},{value:"Additional resources:",id:"additional-resources",level:3}];function u(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.h1,{id:"the-graph",children:"The Graph"}),"\n",(0,t.jsx)(r.h2,{id:"the-graph-quick-start",children:"The Graph Quick Start"}),"\n",(0,t.jsx)(r.p,{children:"Getting historical data on a smart contract can be frustrating when you\u2019re building a dapp. The Graph provides a decentralized option to query smart contract data through APIs known as subgraphs, which utilize GraphQL.\xa0 The Graph\u2019s infrastructure relies on a decentralized network of indexers, enabling your dapp to become truly decentralized."}),"\n",(0,t.jsx)(r.p,{children:"These subgraphs only take a few minutes to set up and get running. To get started, follow these three steps:"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsx)(r.li,{children:"Initialize your subgraph project"}),"\n",(0,t.jsx)(r.li,{children:"Deploy & Publish"}),"\n",(0,t.jsx)(r.li,{children:"Query from your dapp"}),"\n"]}),"\n",(0,t.jsxs)(r.p,{children:["Pricing: ",(0,t.jsx)(r.strong,{children:"All developers receive 100K free queries per month on the decentralized network"}),". After these free queries, you only pay based on usage at $4 for every 100K queries."]}),"\n",(0,t.jsx)(r.p,{children:"Here\u2019s a step by step walk through:"}),"\n",(0,t.jsx)(r.h2,{id:"1-initialize-your-subgraph-project",children:"1. Initialize your subgraph project"}),"\n",(0,t.jsx)(r.h3,{id:"create-a-subgraph-on-subgraph-studio",children:"Create a subgraph on Subgraph Studio\u2060"}),"\n",(0,t.jsxs)(r.p,{children:["Go to the ",(0,t.jsx)(r.a,{href:"https://thegraph.com/studio/",children:"Subgraph Studio"})," and connect your wallet. Once your wallet is connected, you can begin by clicking \u201cCreate a Subgraph\u201d. Please choose a good name for the subgraph because this name can\u2019t be edited later. It is recommended to use Title Case: \u201cSubgraph Name Chain Name.\u201d"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:"https://lh7-us.googleusercontent.com/docsz/AD_4nXf8OTdwMxlKQGKzIF_kYR7NPKeh9TmWnZBYxb7ft_YbdOdx_VVtbp6PslN7N1KGUzNpIDCmaXppdrllM1cw_J4L8Na03BXOWzJTK1POCve0nkRjQYgWJ60QHAdtQ4Niy83SMM8m0F0f-N-AJj4PDqDPlA5M?key=fnI6SyFgXU9SZRNX5C5vPQ",alt:"Create a Subgraph"})}),"\n",(0,t.jsx)(r.p,{children:"You will then land on your subgraph\u2019s page. All the CLI commands you need will be visible on the right side of the page:"}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:"https://lh7-us.googleusercontent.com/docsz/AD_4nXe3YvCxiOH_LupSWe8zh9AmP-VrV4PlOq3f7Ix6hNlBUYcANUFuLuVIWR74OGiBs0nrugTyT0v3o6RPmTsgHONdv_ZJNWtcDWEkRntXPHlQGFcqmEBa-D6j4aoIPzUKYdOJMVUPu8O3fwjdZ4IaXXZoTzY?key=fnI6SyFgXU9SZRNX5C5vPQ",alt:"CLI commands"})}),"\n",(0,t.jsx)(r.h3,{id:"install-the-graph-cli",children:"Install the Graph CLI\u2060"}),"\n",(0,t.jsx)(r.p,{children:"On your local machine run the following:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"npm install -g @graphprotocol/graph-cli\n"})}),"\n",(0,t.jsx)(r.h3,{id:"initialize-your-subgraph",children:"Initialize your Subgraph\u2060"}),"\n",(0,t.jsx)(r.p,{children:"You can copy this directly from your subgraph page to include your specific subgraph slug:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"graph init --studio <SUBGRAPH_SLUG>\n"})}),"\n",(0,t.jsx)(r.p,{children:"You\u2019ll be prompted to provide some info on your subgraph like this:"}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:"https://lh7-us.googleusercontent.com/docsz/AD_4nXdTAUsUb5vbs3GtCrhKhuXM1xYoqqooYTxw6lfJfYtLJNP8GKVOhTPmjxlM1b6Qpx-pXNVOzRuc8BL12wZXqy4MIj8ja0tp15znfuJD_Mg84SSNj3JpQ4d31lNTxPYnpba4UOzZx8pmgOIsbI7vCz70v9gC?key=fnI6SyFgXU9SZRNX5C5vPQ",alt:"cli sample"})}),"\n",(0,t.jsx)(r.p,{children:"Simply have your contract verified on the block explorer and the CLI will automatically obtain the ABI and set up your subgraph. The default settings will generate an entity for each event."}),"\n",(0,t.jsx)(r.h2,{id:"2-deploy--publish",children:"2. Deploy & Publish"}),"\n",(0,t.jsx)(r.h3,{id:"deploy-to-subgraph-studio",children:"Deploy to Subgraph Studio\u2060"}),"\n",(0,t.jsx)(r.p,{children:"First run these commands:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"$ graph codegen\n$ graph build\n"})}),"\n",(0,t.jsx)(r.p,{children:"Then run these to authenticate and deploy your subgraph. You can copy these commands directly from your subgraph\u2019s page in Studio to include your specific deploy key and subgraph slug:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"$ graph auth --studio <DEPLOY_KEY>\n$ graph deploy --studio <SUBGRAPH_SLUG>\n"})}),"\n",(0,t.jsx)(r.p,{children:"You will be asked for a version label. You can enter something like v0.0.1, but you\u2019re free to choose the format."}),"\n",(0,t.jsx)(r.h3,{id:"test-your-subgraph",children:"Test your subgraph\u2060"}),"\n",(0,t.jsx)(r.p,{children:"You can test your subgraph by making a sample query in the playground section. The Details tab will show you an API endpoint. You can use that endpoint to test from your dapp."}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:"https://lh7-us.googleusercontent.com/docsz/AD_4nXf3afwSins8_eO7BceGPN79VvwolDxmFNUnkPk0zAJCaUA-3-UAAjVvrMzwr7q9vNYWdrEUNgm2De2VfQpWauiT87RkFc-cVfoPSsQbYSgsmwhyY1-tpPdv2J1H4JAMq70nfWBhb8PszZBFjsbDAaJ5eto?key=fnI6SyFgXU9SZRNX5C5vPQ",alt:"Playground"})}),"\n",(0,t.jsx)(r.h3,{id:"publish-your-subgraph-to-the-graphs-decentralized-network",children:"Publish Your Subgraph to The Graph\u2019s Decentralized Network"}),"\n",(0,t.jsx)(r.p,{children:"Once your subgraph is ready to be put into production, you can publish it to the decentralized network. On your subgraph\u2019s page in Subgraph Studio, click on the Publish button:"}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:"https://edgeandnode.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa7d6afae-8784-4b15-a90e-ee8f6ee007ba%2F2f9c4526-123d-4164-8ea8-39959c8babbf%2FUntitled.png?table=block&id=37005371-76b4-4780-b044-040a570e3af6&spaceId=a7d6afae-8784-4b15-a90e-ee8f6ee007ba&width=1420&userId=&cache=v2",alt:"publish button"})}),"\n",(0,t.jsx)(r.p,{children:"Before you can query your subgraph, Indexers need to begin serving queries on it. In order to streamline this process, you can curate your own subgraph using GRT."}),"\n",(0,t.jsx)(r.p,{children:"When publishing, you\u2019ll see the option to curate your subgraph. As of May 2024, it is recommended that you curate your own subgraph with at least 3,000 GRT to ensure that it is indexed and available for querying as soon as possible."}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:"https://lh7-us.googleusercontent.com/docsz/AD_4nXerUr-IgWjwBZvp9Idvz5hTq8AFB0n_VlXCzyDtUxKaCTANT4gkk-2O77oW-a0ZWOh3hnqQsY7zcSaLeCQin9XU1NTX1RVYOLFX9MuVxBEqcMryqgnGQKx-MbDnOWKuMoLBhgyVWQereg3cdWtCPcTQKFU?key=fnI6SyFgXU9SZRNX5C5vPQ",alt:"Publish screen"})}),"\n",(0,t.jsx)(r.h2,{id:"3-query-your-subgraph",children:"3. Query your Subgraph"}),"\n",(0,t.jsx)(r.p,{children:"Congratulations! You can now query your subgraph on the decentralized network!"}),"\n",(0,t.jsx)(r.p,{children:"For any subgraph on the decentralized network, you can start querying it by passing a GraphQL query into the subgraph\u2019s query URL which can be found at the top of its Explorer page."}),"\n",(0,t.jsxs)(r.p,{children:["Here\u2019s an example from the ",(0,t.jsx)(r.a,{href:"https://thegraph.com/explorer/subgraphs/HdVdERFUe8h61vm2fDyycHgxjsde5PbB832NHgJfZNqK",children:"CryptoPunks Ethereum subgraph"})," by Messari:"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:"https://lh7-us.googleusercontent.com/docsz/AD_4nXebivsPOUjPHAa3UVtvxoYTFXaGBao9pQOAJvFK0S7Uv0scfL6TcTVjmNCzT4DgsIloAQyrPTCqHjFPtmjyrzoKkfSeV28FjS32F9-aJJm0ILAHey2gqMr7Seu4IqPz2d__QotsWG3OKv2dEghiD74eypzs?key=fnI6SyFgXU9SZRNX5C5vPQ",alt:"Query URL"})}),"\n",(0,t.jsx)(r.p,{children:"The query URL for this subgraph is:"}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.a,{href:"https://gateway-arbitrum.network.thegraph.com/api/**%5Bapi-key%5D**/subgraphs/id/HdVdERFUe8h61vm2fDyycHgxjsde5PbB832NHgJfZNqK",children:"https://gateway-arbitrum.network.thegraph.com/api/**[api-key]**/subgraphs/id/HdVdERFUe8h61vm2fDyycHgxjsde5PbB832NHgJfZNqK"})}),"\n",(0,t.jsx)(r.p,{children:"Now, you simply need to\xa0 fill in your own API Key to start sending GraphQL queries to this endpoint."}),"\n",(0,t.jsx)(r.h3,{id:"getting-your-own-api-key",children:"Getting your own API Key"}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:"https://lh7-us.googleusercontent.com/docsz/AD_4nXdz7H8hSRf2XqrU0jN3p3KbmuptHvQJbhRHOJh67nBfwh8RVnhTsCFDGA_JQUFizyMn7psQO0Vgk6Vy7cKYH47OyTq5PqycB0xxLyF4kSPsT7hYdMv2MEzAo433sJT6VlQbUAzgPnSxKI9a5Tn3ShSzaxI?key=fnI6SyFgXU9SZRNX5C5vPQ",alt:"API keys"})}),"\n",(0,t.jsx)(r.p,{children:"In Subgraph Studio, you\u2019ll see the \u201cAPI Keys\u201d menu at the top of the page. Here you can create API Keys."}),"\n",(0,t.jsx)(r.h2,{id:"appendix",children:"Appendix"}),"\n",(0,t.jsx)(r.h3,{id:"sample-query",children:"Sample Query"}),"\n",(0,t.jsx)(r.p,{children:"This query shows the most expensive CryptoPunks sold."}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-graphql",children:"{\n  trades(orderBy: priceETH, orderDirection: desc) {\n    priceETH\n    tokenId\n  }\n}\n\n"})}),"\n",(0,t.jsx)(r.p,{children:"Passing this into the query URL returns this result:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'{\n  "data": {\n    "trades": [\n      {\n        "priceETH": "124457.067524886018255505",\n        "tokenId": "9998"\n      },\n      {\n        "priceETH": "8000",\n        "tokenId": "5822"\n      },\n//      ...\n'})}),"\n",(0,t.jsx)("aside",{children:(0,t.jsxs)(r.p,{children:["\ud83d\udca1 Trivia: Looking at the top sales on ",(0,t.jsx)(r.a,{href:"https://cryptopunks.app/cryptopunks/topsales",children:"CryptoPunks website"})," it looks like the top sale is Punk #5822, not #9998. Why? Because they censor the flash-loan sale that happened."]})}),"\n",(0,t.jsx)(r.h3,{id:"sample-code",children:"Sample code"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-jsx",children:"const axios = require('axios');\n\nconst graphqlQuery = `{\n  trades(orderBy: priceETH, orderDirection: desc) {\n    priceETH\n    tokenId\n  }\n}`;\nconst queryUrl = 'https://gateway-arbitrum.network.thegraph.com/api/[api-key]/subgraphs/id/HdVdERFUe8h61vm2fDyycHgxjsde5PbB832NHgJfZNqK'\n\nconst graphQLRequest = {\n  method: 'post',\n  url: queryUrl,\n  data: {\n    query: graphqlQuery,\n  },\n};\n\n// Send the GraphQL query\naxios(graphQLRequest)\n  .then((response) => {\n    // Handle the response here\n    const data = response.data.data\n    console.log(data)\n\n  })\n  .catch((error) => {\n    // Handle any errors\n    console.error(error);\n  });\n"})}),"\n",(0,t.jsx)(r.h3,{id:"additional-resources",children:"Additional resources:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["To explore all the ways you can optimize & customize your subgraph for a better performance, read more about ",(0,t.jsx)(r.a,{href:"https://thegraph.com/docs/en/developing/creating-a-subgraph/",children:"creating a subgraph here"}),"."]}),"\n",(0,t.jsxs)(r.li,{children:["For more information about querying data from your subgraph, read more ",(0,t.jsx)(r.a,{href:"https://thegraph.com/docs/en/querying/querying-the-graph/",children:"here"}),"."]}),"\n"]})]})}function d(e={}){const{wrapper:r}={...(0,s.a)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},3837:(e,r,n)=>{n.d(r,{Z:()=>s});n(67294);var t=n(85893);function s(e){let{src:r,caption:n,width:s="460px"}=e;return(0,t.jsxs)("center",{children:[(0,t.jsx)("br",{}),(0,t.jsxs)("figure",{children:[(0,t.jsx)("img",{src:r,alt:n,width:s}),(0,t.jsx)("figcaption",{children:n})]}),(0,t.jsx)("br",{})]})}},11151:(e,r,n)=>{n.d(r,{Z:()=>o,a:()=>i});var t=n(67294);const s={},a=t.createContext(s);function i(e){const r=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(a.Provider,{value:r},e.children)}}}]);