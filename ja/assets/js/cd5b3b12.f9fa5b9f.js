"use strict";(self.webpackChunkdocs_1=self.webpackChunkdocs_1||[]).push([[6623],{10925:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var t=s(85893),i=s(11151);const r={sidebar_position:7},a="Transfer Reserve Assets",o={id:"learn/interoperability/xcm/building-with-xcm/xc-reserve-transfer",title:"Transfer Reserve Assets",description:"XCM allows us to transfer assets from one chain to another in several ways. In this chapter we'll examine how to use reserve transfers.",source:"@site/docs/learn/interoperability/xcm/building-with-xcm/xc-reserve-transfer.md",sourceDirName:"learn/interoperability/xcm/building-with-xcm",slug:"/learn/interoperability/xcm/building-with-xcm/xc-reserve-transfer",permalink:"/ja/docs/learn/interoperability/xcm/building-with-xcm/xc-reserve-transfer",draft:!1,unlisted:!1,editUrl:"https://github.com/AstarNetwork/astar-docs/tree/main/docs/learn/interoperability/xcm/building-with-xcm/xc-reserve-transfer.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"Remote Transact via XCM",permalink:"/ja/docs/learn/interoperability/xcm/building-with-xcm/xc-remote-transact"},next:{title:"Withdraw Assets",permalink:"/ja/docs/learn/interoperability/xcm/building-with-xcm/xc-assets-withdraw"}},c={},d=[];function l(e){const n={a:"a",code:"code",h1:"h1",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"transfer-reserve-assets",children:"Transfer Reserve Assets"}),"\n",(0,t.jsx)(n.p,{children:"XCM allows us to transfer assets from one chain to another in several ways. In this chapter we'll examine how to use reserve transfers."}),"\n",(0,t.jsxs)(n.p,{children:["Suppose we would like to import Shibuya ",(0,t.jsx)(n.code,{children:"SBY"})," tokens as wrapped assets on Shiden, resulting in ",(0,t.jsx)(n.code,{children:"wSBY"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Shibuya network will need to have Shiden's sovereign account. This account is controlled by Shiden and represents all funds sent to it, from the remote chain (Shiden, from Shibuya's perspective in this example)."}),"\n",(0,t.jsxs)(n.li,{children:["Shiden network will need create the ",(0,t.jsx)(n.code,{children:"wSBY"})," asset, and configure it to act as a cross-chain (XC20) asset."]}),"\n",(0,t.jsx)(n.li,{children:"HRMP channels should both be enabled, and configured for parachains to communicate and exchange XCM messages."}),"\n",(0,t.jsxs)(n.li,{children:["In order pay for execution time, ",(0,t.jsx)(n.code,{children:"wSBY"})," should be configured as a payment asset on Shiden."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"During the transfer the following will occur:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["An amount of ",(0,t.jsx)(n.code,{children:"SBY"})," are moved from the source account to the sovereign account of Shiden on Shibuya."]}),"\n",(0,t.jsxs)(n.li,{children:["An XCM message containing the ",(0,t.jsx)(n.code,{children:"ReserveTransferAssets"})," instruction is sent to Shiden."]}),"\n",(0,t.jsxs)(n.li,{children:["The ",(0,t.jsx)(n.code,{children:"ReserveTransferAssets"})," instruction is processed by the ",(0,t.jsx)(n.code,{children:"assets"})," pallet on Shiden, and the corresponding amount of ",(0,t.jsx)(n.code,{children:"wSBY"})," is minted on Shiden."]}),"\n",(0,t.jsxs)(n.li,{children:["Minted ",(0,t.jsx)(n.code,{children:"wSBY"})," tokens are deposited to the destination account."]}),"\n",(0,t.jsxs)(n.li,{children:["A small amount of ",(0,t.jsx)(n.code,{children:"wSBY"})," is deducted from the destination account as payment for execution time"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note:"})," The above example is specific to the implementation of two particular parachains. XCM does not dictate or impose any restrictions on how to interpret incoming messages, or how to manage derivative assets. Other parachains may or may not use the ",(0,t.jsx)(n.code,{children:"assets"})," pallet; the only assumption is that ",(0,t.jsx)(n.code,{children:"assets_reserve_transfer"})," will form an XCM message with an origin specified by its ",(0,t.jsx)(n.code,{children:"parachain_id"}),". Everything else is dependent on the remote chain and its logic, and there are no retries attempted on failure."]}),"\n",(0,t.jsx)(n.h1,{id:"evm-precompiles",children:"EVM precompiles"}),"\n",(0,t.jsxs)(n.p,{children:["This functionality is exposed to EVM smart contracts via precompiles. The interface can be found ",(0,t.jsx)(n.a,{href:"https://github.com/AstarNetwork/Astar",children:"here"})," under XCM precompiles."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"    function assets_reserve_transfer(\n        address[] calldata asset_id,\n        uint256[] calldata asset_amount,\n        bytes32   recipient_account_id,\n        bool      is_relay,\n        uint256   parachain_id,\n        uint256   fee_index\n    ) external payable returns (bool);\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"asset_id"})," - A list of assets to transfer; for transferring native assets, see the next section."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"asset_amount"})," - The corresponding amount of assets."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"recipient_account_id"})," - The recipient account id on the destination chain (or a Relay Chain)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"is_relay"})," Is true if destination account is on the Relay Chain."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"parachain_id"})," - The destination parachain id."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"fee_index"})," - Which asset from ",(0,t.jsx)(n.code,{children:"asset_id"})," is use for paying XCM fees."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note:"})," there is another version of ",(0,t.jsx)(n.code,{children:"assets_reserve_transfer"})," precompile that accepts ",(0,t.jsx)(n.code,{children:"address"})," instead of ",(0,t.jsx)(n.code,{children:"bytes32"})," for the ",(0,t.jsx)(n.code,{children:"recipient_account_id"}),"."]}),"\n",(0,t.jsx)(n.h1,{id:"transferring-native-assets",children:"Transferring Native Assets"}),"\n",(0,t.jsxs)(n.p,{children:["Current API identifes assets being transferred by specifying an H160 style address (XC20). This prevents us from sending native tokens since there's no representation for it. However, there is a workaround for that which uses a special H160 address, padded with zeroes ",(0,t.jsx)(n.code,{children:"0x0000000000000000000000000000000000000000"})," and by convention, is interpreted as a command to send the native token (",(0,t.jsx)(n.code,{children:"MultiLocation { parents: 0, interior: Here }"}),")."]}),"\n",(0,t.jsx)(n.p,{children:"For example, an EVM call such as:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'reserve_transfer:\n    asset_id = [ "0x00...0" ]\n    asset_amount = [ "333333333" ]\n    ...\n    fee_index = 0\n'})}),"\n",(0,t.jsx)(n.p,{children:"The precompile internals will transform call args into something like this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"assets = [{ parents: 0, interior: Here }]\nasset_amounts = [ 333333333 ]\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Native assets can be used for paying transaction fees like any other assets. In that case, the ",(0,t.jsx)(n.code,{children:"fee_index"})," should point to the ",(0,t.jsx)(n.code,{children:"asset_id"})," entry containing ",(0,t.jsx)(n.code,{children:"0x00...0"}),"."]}),"\n",(0,t.jsx)(n.h1,{id:"transaction-fees",children:"Transaction Fees"}),"\n",(0,t.jsx)(n.p,{children:"Every transaction must be paid for. This mechanism is implemented to prevent transaction floods by disincentivizing misuse of the network, so only those tokens that have real value can be used to pay for execution fees."}),"\n",(0,t.jsx)(n.p,{children:"Commonly, we will pay for transactions using the network native token, and it's expected that its emission is controlled and will not cause problems, however in some cases it may be necessary to allow users to pay for transactions, using foreign assets only."}),"\n",(0,t.jsx)(n.p,{children:"To achieve that, the remote chain should be configured to allow payment of XCM execution, in that particular asset."})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},11151:(e,n,s)=>{s.d(n,{Z:()=>o,a:()=>a});var t=s(67294);const i={},r=t.createContext(i);function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);