"use strict";(self.webpackChunkdocs_1=self.webpackChunkdocs_1||[]).push([[8895],{56022:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var t=i(85893),a=i(11151);const r={sidebar_position:1},s="Open HRMP Channels",o={id:"learn/interoperability/xcm/integration/hrmp",title:"Open HRMP Channels",description:"Overview",source:"@site/docs/learn/interoperability/xcm/integration/hrmp.md",sourceDirName:"learn/interoperability/xcm/integration",slug:"/learn/interoperability/xcm/integration/hrmp",permalink:"/ja/docs/learn/interoperability/xcm/integration/hrmp",draft:!1,unlisted:!1,editUrl:"https://github.com/AstarNetwork/astar-docs/tree/main/docs/learn/interoperability/xcm/integration/hrmp.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"FAQ for Smart Contracts",permalink:"/ja/docs/learn/interoperability/xcm/building-with-xcm/faq-for-smart-contracts"},next:{title:"XCM Asset Registration",permalink:"/ja/docs/learn/interoperability/xcm/integration/asset-registration"}},l={},c=[{value:"Overview",id:"overview",level:2},{value:"Technical Instructions",id:"technical-instructions",level:2},{value:"Understanding the Parameters",id:"understanding-the-parameters",level:3},{value:"Relay Chain Encoded Call",id:"relay-chain-encoded-call",level:2},{value:"XCM To Relay Chain",id:"xcm-to-relay-chain",level:2},{value:"Submit Request to Open HRMP Channel",id:"submit-request-to-open-hrmp-channel",level:2},{value:"Workflow",id:"workflow",level:2},{value:"Create Proposal",id:"create-proposal",level:3},{value:"Onboarding on Testnet",id:"onboarding-on-testnet",level:3},{value:"Opening an HRMP Channel",id:"opening-an-hrmp-channel",level:3}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"open-hrmp-channels",children:"Open HRMP Channels"}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"Before two parachains can communicate directly with one another, they must open channels with one another. Since each channel is uni-directional, two of them must be opened; one in each direction."}),"\n",(0,t.jsx)(n.h2,{id:"technical-instructions",children:"Technical Instructions"}),"\n",(0,t.jsx)(n.h3,{id:"understanding-the-parameters",children:"Understanding the Parameters"}),"\n",(0,t.jsx)(n.p,{children:"Opening a channel requires that the parachain sovereign account on the Relay Chain have a balance in the native token (KSM or DOT). This is mandatory, otherwise, the channel opening will fail, as the transactions won't be executed."}),"\n",(0,t.jsxs)(n.p,{children:["The easiest way to check the required parameters is by opening the Relay Chain in ",(0,t.jsx)(n.a,{href:"https://polkadot.js.org/apps/#/explorer",children:"Polkadot.js Apps"}),", under Developer -> Chain State -> ",(0,t.jsx)(n.code,{children:"configuration"})," -> ",(0,t.jsx)(n.code,{children:"activeConfig"}),". What you're interested in will look like this (taken from Polkadot):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:"hrmpMaxParachainOutboundChannels: 30\nhrmpMaxParathreadOutboundChannels: 0\nhrmpSenderDeposit: 100,000,000,000\nhrmpRecipientDeposit: 100,000,000,000\nhrmpChannelMaxCapacity: 1,000\nhrmpChannelMaxTotalSize: 102,400\nhrmpMaxParachainInboundChannels: 30\nhrmpMaxParathreadInboundChannels: 0\nhrmpChannelMaxMessageSize: 102,400\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Based on the information above, we can see that ",(0,t.jsx)(n.strong,{children:"10 DOT"})," is required to open a channel or to confirm it. We can also see that there are a maximum number of inbound and outbound channels per parachain - 30 in the case of Polkadot, at the time of this writing."]}),"\n",(0,t.jsx)(n.p,{children:"The two parameters that need to be specified when opening a channel are:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"max_capacity"})," - max number of messages that can be queued in the channel."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"max_message_size"})," - max size of the message being sent."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"We can choose the max values when opening the channel accordingly."}),"\n",(0,t.jsx)(n.h2,{id:"relay-chain-encoded-call",children:"Relay Chain Encoded Call"}),"\n",(0,t.jsx)(n.p,{children:"The first step is to prepare the encoded call data for either requesting channel opening, or accepting an existing open channel request."}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Visit polkadot.js app in your browser and select either Polkadot or Kusama."}),"\n",(0,t.jsxs)(n.li,{children:["Click on ",(0,t.jsx)(n.code,{children:"Developer -> Extrinsic"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"Find hrmp under all the available pallets and select it."}),"\n",(0,t.jsxs)(n.li,{children:["Select the ",(0,t.jsx)(n.code,{children:"hrmpInitOpenChannel"})," call and fill out the parameters.","\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"recipient"}),": the parachain with which you want to open the channel."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"proposedMaxCapacity"}),": pick the value from activeConfig."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"proposedMaxMessageSize"}),": pick the value from activeConfig."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Copy and store the encoded call data for later:","\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["e.g. ",(0,t.jsx)(n.code,{children:"0x3c00d6070000e803000000900100"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"You can repeat the exact same steps to get the encoded call data for hrmpAcceptOpenChannel."}),"\n",(0,t.jsx)(n.h2,{id:"xcm-to-relay-chain",children:"XCM To Relay Chain"}),"\n",(0,t.jsxs)(n.p,{children:["The assumption here is that you're using Polkadot's standard ",(0,t.jsx)(n.code,{children:"pallet-xcm"}),", which has a send call."]}),"\n",(0,t.jsxs)(n.p,{children:["Using a ",(0,t.jsx)(n.strong,{children:"root"})," call from your parachain, you should send an XCM message to the Relay Chain, instructing it to execute the encoded call data you've prepared in the previous step."]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Open your parachain in ",(0,t.jsx)(n.a,{href:"https://polkadot.js.org/apps",children:"polkadot.js app"})]}),"\n",(0,t.jsxs)(n.li,{children:["Click on ",(0,t.jsx)(n.code,{children:"Developer -> Extrinsic"})]}),"\n",(0,t.jsxs)(n.li,{children:["Find the XCM pallet in the dropdown menu (probably called ",(0,t.jsx)(n.code,{children:"polkadotXcm"})," or ",(0,t.jsx)(n.code,{children:"xcmPallet"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Select ",(0,t.jsx)(n.code,{children:"send"})," as the call:","\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"destination"}),": ",(0,t.jsx)(n.code,{children:"V1 {XcmV1MultiLocation { parents: 1, interior: Here}}"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"message"}),":","\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"V2"})," (or latest supported version)"]}),"\n",(0,t.jsx)(n.li,{children:"Now add 5 instructions to the message."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"WithdrawAsset"}),": ",(0,t.jsx)(n.code,{children:"{Concrete {0, Here}, Fungible {1000000000000}}"}),":","\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"1 DOT or 1 KSM is sufficient to execute this."}),"\n",(0,t.jsx)(n.li,{children:"You must ensure that your sovereign account on the Relay Chain is sufficiently funded."}),"\n",(0,t.jsxs)(n.li,{children:["Refer to ",(0,t.jsx)(n.a,{href:"https://app.gitbook.com/o/-LgGrgOEDyFYjYWIb1DT/s/-M8GVK5H7hOsGnYqg-7q-872737601/~/changes/AhpKoCvdYLwztMP8vCAb/xcm/xcm-integration/xcm-tools",children:"XCM Tools"})," page for help with calculating the sovereign account."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"BuyExecution"}),": ",(0,t.jsx)(n.code,{children:"{Concrete {0, Here}, Fungible {1000000000000}, Unlimited}"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Transact"}),": ",(0,t.jsx)(n.code,{children:"{Native, 1000000000, <encoded_call_data>}"}),":","\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Use the encoded call data you've prepared before."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"RefundSurplus"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"DepositAsset"}),": ",(0,t.jsx)(n.code,{children:"{Wild {All}, 1, {parents: 0, interior: X1(Parachain(2007))}}"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Send and then verify the execution on the Relay Chain"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"You will need to send two such calls for both accepting request, and initiating it (or you can prepare a batch call). Once a channel has been accepted, it will become available at the start of next session."}),"\n",(0,t.jsx)(n.h2,{id:"submit-request-to-open-hrmp-channel",children:"Submit Request to Open HRMP Channel"}),"\n",(0,t.jsxs)(n.p,{children:["To open an HRMP channel with Astar or Shiden you will need to create a proposal on our ",(0,t.jsx)(n.a,{href:"https://forum.astar.network/",children:"forum"}),". Create your proposal in the correct category:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Shiden Network: ",(0,t.jsx)(n.a,{href:"https://forum.astar.network/c/shiden/proposal/10",children:"https://forum.astar.network/c/shiden/proposal/10"})]}),"\n",(0,t.jsxs)(n.li,{children:["Astar Network: ",(0,t.jsx)(n.a,{href:"https://forum.astar.network/c/astar/proposal/20",children:"https://forum.astar.network/c/astar/proposal/20"})]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["We have created a template that you can use to post your proposal, which you can find ",(0,t.jsx)(n.a,{href:"https://astarnetwork.notion.site/Open-HRMP-Channel-Template-166eb1b8202d4439a8c00e4a50fe0d89",children:"here"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"workflow",children:"Workflow"}),"\n",(0,t.jsx)(n.h3,{id:"create-proposal",children:"Create Proposal"}),"\n",(0,t.jsx)(n.p,{children:"After creating your proposal, we will inform our community, and it is expected that you should follow up in case the community has questions. To continue with the next step you will need to be approved by our council (governance), which will be done through a poll on our forum."}),"\n",(0,t.jsx)(n.h3,{id:"onboarding-on-testnet",children:"Onboarding on Testnet"}),"\n",(0,t.jsx)(n.p,{children:"The first step is for the parachain to onboard their testnet to the Rococo Relay Chain. Once that is done, you should inform us about your endpoint and parachain Id."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Exchange public endpoints."}),"\n",(0,t.jsx)(n.li,{children:"Exchange parachain-Ids."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"We will open channels, register assets and initiate test transfers."}),"\n",(0,t.jsx)(n.h3,{id:"opening-an-hrmp-channel",children:"Opening an HRMP Channel"}),"\n",(0,t.jsxs)(n.p,{children:["After testing on Rococo, we will begin the process of opening the HRMP channel, and if necessary, will also initiate the process adding the XCM asset. Read more about adding XCM assets ",(0,t.jsx)(n.a,{href:"https://app.gitbook.com/o/-LgGrgOEDyFYjYWIb1DT/s/-M8GVK5H7hOsGnYqg-7q-872737601/xcm/xcm-integration/xcm-asset-registration",children:"here"}),"."]})]})}function d(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>o,a:()=>s});var t=i(67294);const a={},r=t.createContext(a);function s(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);